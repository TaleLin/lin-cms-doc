(window.webpackJsonp=window.webpackJsonp||[]).push([[152],{532:function(t,s,a){"use strict";a.r(s);var n=a(26),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"文件上传系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件上传系统"}},[t._v("#")]),t._v(" 文件上传系统")]),t._v(" "),a("h2",{attrs:{id:"概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),a("p",[t._v("在一个CMS系统中，除了增删改查的业务，可能最刚需的功能的就是图片上传了，\n而图片又是属于文件的范畴，所以，为了避免开发者重复编写上传相关的业务代码，\nLin 为开发者提供了一个文件上传系统。")]),t._v(" "),a("p",[t._v("在 flask 框架中，虽说已经内置好了文件上传操作，但如果你想实现一个功能比较完备的文件上传系统，可能还需要考虑到诸如文件扩展名校验、文件大小校验、文件数量校验、文件存储位置等等问题。")]),t._v(" "),a("p",[t._v("lin 提供的文件上传系统，已经封装好了上述比较棘手耗时的功能，这可以帮助你简单快速地实现文件上传的相关业务。")]),t._v(" "),a("h2",{attrs:{id:"使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[t._v("#")]),t._v(" 使用")]),t._v(" "),a("h3",{attrs:{id:"模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模式"}},[t._v("#")]),t._v(" 模式")]),t._v(" "),a("p",[t._v("我们把 lin 的文件上传接口定到了"),a("code",[t._v("cms/file/")]),t._v("这个路径上，你可以通过 post 方法上传文件。lin 默认的文件上传实现"),a("code",[t._v("LocalUploader")]),t._v("这个类，意思是前端上传的文件会保存到服务器本地，但更多的时候我们需要将文件保存到云服务器上，如阿里云或腾讯云，lin 并没有局限在此，你可以自己实现存储文件的逻辑，将文件保存到你希望的地方。")]),t._v(" "),a("p",[t._v("对于文件上传("),a("code",[t._v("file")]),t._v(")这种可以有多种实现方式的功能，我们把其诸多实现归入\n到"),a("code",[t._v("app/extensions/file")]),t._v("这个目录下。如"),a("code",[t._v("local_uploader.py")]),t._v("这个文件实现了上传到本地\n的"),a("code",[t._v("LocalUploader")]),t._v("类，"),a("code",[t._v("config.py")]),t._v("文件是与其相关的配置文件。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("app/extensions/\n└── "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v("\n    ├── config.py  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置文件")]),t._v("\n    └── local_uploader.py "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# LocalUploader类实现文件")]),t._v("\n")])])]),a("p",[t._v("默认的情况下在，"),a("code",[t._v("cms/file/")]),t._v("这个接口使用"),a("code",[t._v("LocalUploader")]),t._v("这个文件上传实现类。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@file_api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" methods"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'POST'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@login_required")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("post_file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 解析前端上传的文件")]),t._v("\n    files "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("files\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将解析后的字典作为参数传入LoaclUploader类")]),t._v("\n    uploader "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" LocalUploader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("files"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" uploader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("upload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" jsonify"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("在这段代码中， 我们首先调用了flask的请求对象"),a("code",[t._v("request")]),t._v("上的"),a("code",[t._v("files")]),t._v("字典，它会为我们自动解析客户端传输过来的文件，然后实例化了"),a("code",[t._v("LocalUploader")]),t._v("类，并将"),a("code",[t._v("files")]),t._v("作为构造参数传递给 LocalUploader，在LocalUploader构造方法中，我们校验了客户端传输过来的文件是否符合我们约定的配置，最后调用其"),a("code",[t._v("upload")]),t._v("方法。")]),t._v(" "),a("p",[t._v("记住这一步，它是固定的，任何继承自"),a("code",[t._v("Uploader")]),t._v("这个基类的实现类必须重写"),a("code",[t._v("upload")]),t._v("方法\n，如"),a("code",[t._v("LocalUploader")]),t._v("中：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LocalUploader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Uploader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("upload")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n")])])]),a("p",[t._v("当需要实现其它的上传类时，如上传到阿里云 OSS，我们只需要重新定义一个"),a("code",[t._v("Aliyun")]),t._v("类，\n在类中重新实现这个"),a("code",[t._v("upload")]),t._v("方法，而后在视图函数中，更\n换"),a("code",[t._v("LocalUploader")]),t._v("为"),a("code",[t._v("Aliyun")]),t._v("即可快速切换。")]),t._v(" "),a("h3",{attrs:{id:"实操"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实操"}},[t._v("#")]),t._v(" 实操")]),t._v(" "),a("p",[t._v("在具体的实践之前，我们需要了解一下"),a("code",[t._v("file")]),t._v("的具体配置。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("FILE "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"STORE_DIR"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app/assets'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 文件的存储路径")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SINGLE_LIMIT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 单个文件的大小限制，默认2M")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TOTAL_LIMIT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 所有文件的大小限制，默认20M")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NUMS"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 文件数量限制，默认10")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"INCLUDE"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("                   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 文件后缀名的排除项，默认排除[]，即允许所有类型的文件上传")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"EXCLUDE"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 文件后缀名的包括项")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("为了提高配置的灵活性，你也可以在实例化Uploader的实现类的时候，指定 config 参数来传入你的自定义配置。方法如下：")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# config 参数为一个字典。注意：当字典的key值和上述6个配置项key值相同时，才会被解析")]),t._v("\nuploader "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" LocalUploader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("files"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'NUMS'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SINGLE_LIMIT'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("在单个配置的后面，笔者已经以注释的方式解释了每项的作用。当然还需要着重解释一下"),a("code",[t._v("exclude")]),t._v("和"),a("code",[t._v("include")]),t._v("\n这两项，默认情况下，只会读取它们中的一项，如果两项皆为空列表的话，所有的文件类型都会被允许上传，如果二者都不是空列表则取"),a("code",[t._v("include")]),t._v("为有效配置，总而言之，系统只会支持使用一项。")]),t._v(" "),a("p",[t._v("注意了！！！在"),a("code",[t._v("app/extensions/")]),t._v("下的配置文件，系统不会帮我们做自动加载，不同于\n"),a("code",[t._v("app/config")]),t._v("。因此，你必须在"),a("code",[t._v("app/app.py")]),t._v("的"),a("code",[t._v("create_app")]),t._v("方法中，显示的加载该配置文件")]),t._v(" "),a("div",{staticClass:"language-py extra-class"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 手动加载配置文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_app")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("register_all"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Flask"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__name__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" static_folder"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./assets'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("from_object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app.config.setting'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("from_object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app.config.secure'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 加载其他配置文件：")]),t._v("\n    app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("from_object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app.extensions.file.config'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),a("p",[t._v("当做好了这些后，我们使用 postman 测试一下文件上传。")]),t._v(" "),a("img-wrapper",[a("img",{attrs:{src:"http://imglf5.nosdn0.126.net/img/L1FxUmNhYXM3L2ZWaFZGUFVNRWJBbmZMYldnckpPNEk0RjNJcEM3K3duYmxMeEJxMm1hOGFnPT0.png?imageView&thumbnail=2090y1120&quality=96&stripmeta=0"}})]),t._v(" "),a("p",[t._v("上传成功后，我们会得到如下的结果：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"key"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"one"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"path"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2019/07/17/e892f8da-a840-11e9-8088-c4b30191a4f8.png"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"url"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://127.0.0.1:5000/assets/2019/07/17/e892f8da-a840-11e9-8088-c4b30191a4f8.png"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"key"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"two"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"path"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2019/07/17/e89816ba-a840-11e9-9f59-c4b30191a4f8.png"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"url"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://127.0.0.1:5000/assets/2019/07/17/e89816ba-a840-11e9-9f59-c4b30191a4f8.png"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("由于上传了两个文件，因此我们得到了两个元素的数组，它们的结构如下：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("name")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("说明")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("类型")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("id")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("文件存储到数据库的 id")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("string")])]),t._v(" "),a("tr",[a("td",[t._v("key")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("文件上传的 key")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("string")])]),t._v(" "),a("tr",[a("td",[t._v("path")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("文件的服务器本地相对路径")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("string")])]),t._v(" "),a("tr",[a("td",[t._v("url")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("可访问的 url")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("string")])])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("系统会自动帮助我们上传的文件做 md5，因此你大可不必担心文件重复上传，如果你上传了\n重复的文件，服务器会返回已传文件的数据。")])])],1)}),[],!1,null,null,null);s.default=e.exports}}]);